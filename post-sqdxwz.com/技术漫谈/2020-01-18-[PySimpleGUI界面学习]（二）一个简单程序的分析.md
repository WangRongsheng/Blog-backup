---
layout: post
cid: 95
title: [PySimpleGUI界面学习]（二）一个简单程序的分析
slug: 95
date: 2020/01/18 12:53:00
updated: 2020/01/18 12:54:12
status: publish
author: 王荣胜
categories: 
  - 技术漫谈
tags: 
  - 界面可视化
---


<!--more-->
# 回顾

在上一篇文章中简单介绍了PySimpleGUI这个工具包，在结束的时候给出一个简单的例子，这个例子展示了一个简单的窗口，虽然只有短短五行代码，但是已经将如何创建一个窗口的几乎所有重要元素全部涵盖，本章将详细分析一下这五行代码。

```python
import PySimpleGUI as sg
layout = [ [sg.Text('输入你的名字'), sg.InputText()],  [sg.OK()] ]
window = sg.Window('我的第一个GUI窗口').Layout(layout)
button, values = window.Read()
window.Close()
```

# 分析

第1句是导入语句，这是标准的Python导入格式，as只是另取一个名字而已，目的只是为了书写方便。

第2句是创建界面上的内容，从运行代码所得的窗口界面，可以看到其上所有的控件，在这个界面上一共有三个控件，一是展示提示文字，二是接收用户的输入，三是一个OK按钮。

为了创建这三个按钮，PySimpleGUI创建了一种独特的列表方法，即将这些控件放在一个列表之中。

那么问题来了，如果将所有的控件只是简单的依次放在列表中，那之后的创建程序如何区分谁在上谁在下谁在左谁在右呢？为了解决这个问题，天才程序员们想出一个奇妙的规定，完美的解决了这个问题：将界面先按从上到下来排列，这样就分出若干行，然后在每行的控件中从左向右排列，这有些象二维矩阵的样子，于是只需要在大列表之中再嵌套一些子列表即可，每一个子列表即代表每一行的控件组，而子列表的排列顺序恰恰就是界面从上到下的排列顺序，其中每个子列表中控件排列顺序即是每行从左到右的排列顺序。

好了，PySimpleGUI的主要秘密之一就是这个，众所周知，Python的列表处理功能极其强大，强大到在列表中可以写语句，那么这个工具包选用这种方式来构建整个界面元素，必将极大地方便了程序员对于界面控件的控制。

第3句即调用该工具包中的Window函数来创建一个窗体，本身可以分步来写，即：

```python
window = sg.Window('我的第一个GUI窗口')
window.Layout(layout)
```

这两句表明先创建一个窗口，然后将刚才创建的控件列表摆放到这个窗口上即可。原程序中只用一句，是利用了Python的强大的语法功能将其合二为一。

至此，这个界面已经创建完成。那么为什么我们还没有看到呢？这是一个好问题，要知道界面创建出来的最主要目的就是和用户进行交互，即界面要承载所有用户的输入，如果将界面看做一个小机器人，那么它一旦显示出来就是要不断读取用户的数据，根据这个逻辑，天才的程序员们又为窗体实现了一个强大的Read接口，这个接口函数可以读取用户对于界面的所有行为，然后将这些乱七八糟的行为以有序的方式返回到程序中，并且为了容易区分起见，将用户行为分为两类：一类是用户点击的控件名称，一类是用户输入的数据，这段小程序的第4句即展示了这一技术细节：

```python
button, values = window.Read()
```

这个语句的第一个返回值只是OK按钮的名字，第二个values是一个列表，其中包含用户在文本框中输入的字符串。

如果你按照这段代码运行的时候，会发现一个问题，即当你点击OK按钮时，窗体即可消失。但是真正关闭窗体的语句其实是由第5句语句执行的，即：

```python
window.Close()
```

那么又出现一个问题：即为什么用户只点击OK按钮，窗体就不见了呢？

对了，这又引出另一个话题，即在PySimpleGUI的包设计中，窗体可分为两类：一类是***一次性窗口(One-shot Window)***，即展示一下获取用户输入后即消失的，最常见的比如常用的聊天软件的登录界面，而我们的例子就是一个典型的一次性窗口；另一类是***持久性窗口(Persistent window)***，这类窗口将一直保留着，直到用户发出关闭指令才关闭，比如某聊天工具的聊天窗口、某办公软件的录入界面等等，这类窗口相对复杂，然而值得一提的是，天才程序们员仅仅用一个死循环的等待方式即得到了简便的处理方法，有关这一方法，下次再详细讨论。